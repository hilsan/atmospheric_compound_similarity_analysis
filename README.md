# Similarity Analysis for Atmospheric Compounds

**DOI / Citation:** [Published version on Zenodo](https://doi.org/10.5281/zenodo.14007730)  

Python-based analysis of molecular similarity in atmospheric and non-atmospheric compound datasets using fingerprints and t-SNE clustering. The workflow quantifies molecular fragments, sizes, atomic ratios, and pairwise similarities to identify atmospherically relevant patterns.

---

## Overview

The project performs three main analyses:

1. **Fragment and Composition Analysis** – examines molecular size, atomic ratios, and atmospherically relevant fragments.
2. **Fingerprint Comparison & Clustering** – generates MACCS and RDKit topological fingerprints and visualizes dataset relationships with t-SNE.
3. **Pairwise Similarity Analysis** – calculates Tanimoto similarity between molecules across datasets to evaluate similarity distributions.

Datasets include publicly available atmospheric and non-atmospheric compounds (Wang et al., Isaacman-VanVertz & Aumont, Tabor et al., MassBank EU, MONA, Ramakrishnan et al., Krabrov et al.).  

A specific version of this project used for atmospheric compound analysis is available [here](https://zenodo.org/records/14107768).

---

## Requirements

- Python 3.10+
- Required libraries: see `requirements.txt`
- Dependencies:
  - [aprl_ssp](https://github.com/stakahama/aprl-ssp/tree/master/SMARTSpatterns)
  - [MolAnalysis](https://gitlab.com/hilsan/MolAnalysis.git) ([Zenodo DOI](https://doi.org/10.5281/zenodo.14007835))

> **Note:** Some scripts contain hard-coded paths; adjust them according to your file system.

---

## Project Structure

src/
data/ # Preprocessing scripts for raw datasets
features/ # Descriptor and fingerprint generation
fingerprint_comparison/ # TSNE and Tanimoto similarity calculations

notebook/ # Example workflows and manuscript figures
data/ # Place raw datasets here
reports/ # Generated figures and analysis
---

## Key Scripts / Notebooks

- `notebook/run_project.ipynb` – full workflow for reproducing analysis
- `notebook/for_manuscript.ipynb` – code for manuscript figures
- `notebook/psat.ipynb` – vapor pressure comparison plots
- `notebook/calculate_max_similarity.ipynb` – nearest-neighbor similarity analysis

---

## Usage

1. Place raw data in `data/raw/` following the dataset folder structure described in the notebooks.
2. Run `notebook/run_project.ipynb` to reproduce the analysis.
3. Generated figures and reports will be saved in the `reports/` folder.

---

## Example Output

Example t-SNE plot generated by the workflow:  
![t-SNE example](figures/tsne_example.png)  


---

## License & Citation

Please cite the Zenodo DOI if you use this project: [https://doi.org/10.5281/zenodo.14007730](https://doi.org/10.5281/zenodo.14007730)
